# éº¦éº¦ï¼MaiMBot (ç¼–è¾‘ä¸­) 


<div align="center">


![Python Version](https://img.shields.io/badge/Python-3.x-blue)
![License](https://img.shields.io/github/license/SengokuCola/MaiMBot)
![Status](https://img.shields.io/badge/çŠ¶æ€-å¼€å‘ä¸­-yellow)

</div>

## ğŸ“ é¡¹ç›®ç®€ä»‹

**éº¦éº¦qqæœºå™¨äººçš„æºä»£ç ä»“åº“**

åŸºäºllmã€napcatã€nonebotå’Œmongodbçš„ä¸“æ³¨äºç¾¤èŠå¤©çš„qqbot

<div align="center">
<a href="https://www.bilibili.com/video/BV1amAneGE3P" target="_blank">
    <img src="https://i0.hdslb.com/bfs/archive/7d9fa0a88e8a1aa01b92b8a5a743a2671c0e1798.jpg" width="500" alt="éº¦éº¦æ¼”ç¤ºè§†é¢‘">
    <br>
    ğŸ‘† ç‚¹å‡»è§‚çœ‹éº¦éº¦æ¼”ç¤ºè§†é¢‘ ğŸ‘†
</a>
</div>

> âš ï¸ **è­¦å‘Š**ï¼šä»£ç å¯èƒ½éšæ—¶æ›´æ”¹ï¼Œç›®å‰ç‰ˆæœ¬ä¸ä¸€å®šæ˜¯ç¨³å®šç‰ˆæœ¬
> âš ï¸ **è­¦å‘Š**ï¼šè¯·è‡ªè¡Œäº†è§£qqbotçš„é£é™©ï¼Œéº¦éº¦æœ‰æ—¶å€™ä¸€å¤©è¢«è…¾è®¯è‚˜ä¸ƒå…«æ¬¡
> âš ï¸ **è­¦å‘Š**ï¼šç”±äºéº¦éº¦ä¸€ç›´åœ¨è¿­ä»£ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ä¸€äº›bugï¼Œè¯·è‡ªè¡Œæµ‹è¯•ï¼ŒåŒ…æ‹¬èƒ¡è¨€ä¹±è¯­ï¼ˆ

å…³äºéº¦éº¦çš„å¼€å‘å’Œå»ºè®®ç›¸å…³çš„è®¨è®ºç¾¤:766798517ï¼ˆä¸å»ºè®®å‘å¸ƒæ— å…³æ¶ˆæ¯ï¼‰è¿™é‡Œä¸ä¼šæœ‰éº¦éº¦å‘è¨€ï¼

## å¼€å‘è®¡åˆ’TODOï¼šLIST

- å…¼å®¹gifçš„è§£æå’Œä¿å­˜
- å°ç¨‹åºè½¬å‘é“¾æ¥è§£æ
- å¯¹æ€è€ƒé“¾é•¿åº¦é™åˆ¶
- ä¿®å¤å·²çŸ¥bug
- å®Œå–„æ–‡æ¡£
- ä¿®å¤è½¬å‘
- configè‡ªåŠ¨ç”Ÿæˆå’Œæ£€æµ‹
- logåˆ«ç”¨print
- ç»™å‘é€æ¶ˆæ¯å†™ä¸“é—¨çš„ç±»
- æ”¹è¿›è¡¨æƒ…åŒ…å‘é€é€»è¾‘l


## ğŸ“š è¯¦ç»†æ–‡æ¡£
- [é¡¹ç›®è¯¦ç»†ä»‹ç»å’Œæ¶æ„è¯´æ˜](docs/doc1.md) - åŒ…å«å®Œæ•´çš„é¡¹ç›®ç»“æ„ã€æ–‡ä»¶è¯´æ˜å’Œæ ¸å¿ƒåŠŸèƒ½å®ç°ç»†èŠ‚(ç”±claude-3.5-sonnetç”Ÿæˆ)

### å®‰è£…æ–¹æ³•ï¼ˆè¿˜æ²¡æµ‹è¯•å¥½ï¼Œéšæ—¶outdated ,ç°åœ¨éƒ¨ç½²å¯èƒ½é‡åˆ°æœªçŸ¥é—®é¢˜ï¼ï¼ï¼ï¼ï¼‰

#### Linux ä½¿ç”¨ Docker Compose éƒ¨ç½²
è·å–é¡¹ç›®æ ¹ç›®å½•ä¸­çš„```docker-compose.yml```æ–‡ä»¶ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤
```bash
NAPCAT_UID=$(id -u) NAPCAT_GID=$(id -g) docker compose up -d
```
é…ç½®æ–‡ä»¶ä¿®æ”¹å®Œæˆåï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤
```bash
NAPCAT_UID=$(id -u) NAPCAT_GID=$(id -g) docker compose restart
```

#### æ‰‹åŠ¨è¿è¡Œ
1. **åˆ›å»ºPythonç¯å¢ƒ**
   æ¨èä½¿ç”¨condaæˆ–å…¶ä»–è™šæ‹Ÿç¯å¢ƒè¿›è¡Œä¾èµ–å®‰è£…ï¼Œé˜²æ­¢å‡ºç°ä¾èµ–ç‰ˆæœ¬å†²çªé—®é¢˜
   ```bash
   # å®‰è£…requirements
   pip install -r requirements.txt
   ```
2. **MongoDBè®¾ç½®**
   - å®‰è£…å¹¶è¿è¡Œmongodb
   - éº¦éº¦botä¼šè‡ªåŠ¨è¿æ¥é»˜è®¤çš„mongodbï¼Œç«¯å£å’Œæ•°æ®åº“åå¯é…ç½®

3. **Napcaté…ç½®**
   - å®‰è£…å¹¶è¿è¡ŒNapcatï¼Œç™»å½•
   - åœ¨Napcatçš„ç½‘ç»œè®¾ç½®ä¸­æ·»åŠ wsåå‘ä»£ç†:ws://localhost:8080/onebot/v11/ws

4. **é…ç½®æ–‡ä»¶è®¾ç½®**
   - å°†.envæ–‡ä»¶æ‰“å¼€ï¼Œå¡«ä¸Šä½ çš„apikeyï¼ˆç¡…åŸºæµåŠ¨æˆ–deepseekapiï¼‰
   - å°†bot_config.tomlæ–‡ä»¶æ‰“å¼€ï¼Œå¹¶å¡«å†™ç›¸å…³å†…å®¹ï¼Œä¸ç„¶æ— æ³•æ­£å¸¸è¿è¡Œ

   #### .env æ–‡ä»¶é…ç½®è¯´æ˜
   ```ini
   # ç¯å¢ƒé…ç½®
   ENVIRONMENT=dev          # å¼€å‘ç¯å¢ƒè®¾ç½®
   HOST=127.0.0.1          # ä¸»æœºåœ°å€
   PORT=8080               # ç«¯å£å·

   # å‘½ä»¤å‰ç¼€è®¾ç½®
   COMMAND_START=["/"]     # å‘½ä»¤èµ·å§‹ç¬¦

   # æ’ä»¶é…ç½®
   PLUGINS=["src2.plugins.chat"]  # å¯ç”¨çš„æ’ä»¶åˆ—è¡¨

   # MongoDBé…ç½®
   MONGODB_HOST=127.0.0.1        # MongoDBä¸»æœºåœ°å€
   MONGODB_PORT=27017            # MongoDBç«¯å£
   DATABASE_NAME=MegBot          # æ•°æ®åº“åç§°
   MONGODB_USERNAME=""           # MongoDBç”¨æˆ·åï¼ˆå¯é€‰ï¼‰
   MONGODB_PASSWORD=""           # MongoDBå¯†ç ï¼ˆå¯é€‰ï¼‰
   MONGODB_AUTH_SOURCE=""        # MongoDBè®¤è¯æºï¼ˆå¯é€‰ï¼‰

   #apié…ç½®é¡¹ï¼Œå»ºè®®siliconflowå¿…å¡«ï¼Œè¯†å›¾éœ€è¦è¿™ä¸ª
   SILICONFLOW_KEY=
   SILICONFLOW_BASE_URL=https://api.siliconflow.cn/v1/
   DEEP_SEEK_KEY=
   DEEP_SEEK_BASE_URL=https://api.deepseek.com/v1
   ```

   #### bot_config.toml æ–‡ä»¶é…ç½®è¯´æ˜
   ```toml
   # æ•°æ®åº“è®¾ç½®
   [database]
   host = "127.0.0.1"      # MongoDBä¸»æœºåœ°å€
   port = 27017            # MongoDBç«¯å£
   name = "MegBot"         # æ•°æ®åº“åç§°

   # æœºå™¨äººåŸºæœ¬è®¾ç½®
   [bot]
   qq =                    # ä½ çš„æœºå™¨äººQQå·ï¼ˆå¿…å¡«ï¼‰
   nickname = "éº¦éº¦"       # æœºå™¨äººæ˜µç§°

   # æ¶ˆæ¯å¤„ç†è®¾ç½®
   [message]
   min_text_length = 2     # æœ€å°å“åº”æ–‡æœ¬é•¿åº¦
   max_context_size = 15   # ä¸Šä¸‹æ–‡æœ€å¤§ä¿å­˜æ•°é‡
   emoji_chance = 0.2      # è¡¨æƒ…åŒ…ä½¿ç”¨æ¦‚ç‡

   # è¡¨æƒ…åŒ…åŠŸèƒ½è®¾ç½®
   [emoji]
   check_interval = 120    # è¡¨æƒ…æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
   register_interval = 10  # è¡¨æƒ…æ³¨å†Œé—´éš”ï¼ˆç§’ï¼‰

   # CQç è®¾ç½®
   [cq_code]
   enable_pic_translate = false  # æ˜¯å¦å¯ç”¨å›¾ç‰‡è½¬æ¢ï¼ˆæ— æ•ˆï¼‰

   # å“åº”è®¾ç½®
   [response]
   api_using = "siliconflow"     # å›å¤ä½¿ç”¨çš„APIï¼ˆsiliconflow/deepseekï¼‰
   model_r1_probability = 0.8    # R1æ¨¡å‹ä½¿ç”¨æ¦‚ç‡
   model_v3_probability = 0.1    # V3æ¨¡å‹ä½¿ç”¨æ¦‚ç‡
   model_r1_distill_probability = 0.1  # R1è’¸é¦æ¨¡å‹ä½¿ç”¨æ¦‚ç‡ï¼ˆå¯¹deepseek api æ— æ•ˆï¼‰

   # å…¶ä»–è®¾ç½®
   [others]
   enable_advance_output = false  # æ˜¯å¦å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡º

   # ç¾¤ç»„è®¾ç½®
   [groups]
   talk_allowed = [              # å…è®¸å›å¤çš„ç¾¤å·åˆ—è¡¨
       # åœ¨è¿™é‡Œæ·»åŠ ç¾¤å·,é€—å·éš”å¼€
   ]
   
   talk_frequency_down = [       # é™ä½å›å¤é¢‘ç‡çš„ç¾¤å·åˆ—è¡¨
       # åœ¨è¿™é‡Œæ·»åŠ ç¾¤å·,é€—å·éš”å¼€
   ]
   
   ban_user_id = [              # ç¦æ­¢å›å¤çš„ç”¨æˆ·QQå·åˆ—è¡¨
       # åœ¨è¿™é‡Œæ·»åŠ QQå·,é€—å·éš”å¼€
   ]
   ```

5. **è¿è¡Œéº¦éº¦**
   åœ¨å«æœ‰bot.pyç¨‹åºçš„ç›®å½•ä¸‹è¿è¡Œï¼ˆå¦‚æœä½¿ç”¨äº†è™šæ‹Ÿç¯å¢ƒéœ€è¦å…ˆè¿›å…¥è™šæ‹Ÿç¯å¢ƒï¼‰
   ```bash
   nb run
   ```
6. **è¿è¡Œå…¶ä»–ç»„ä»¶**
   run_thingking.bat å¯ä»¥å¯åŠ¨å¯è§†åŒ–çš„æ¨ç†ç•Œé¢ï¼ˆæœªå®Œå–„ï¼‰å’Œæ¶ˆæ¯é˜Ÿåˆ—åŠå…¶ä»–ä¿¡æ¯é¢„è§ˆï¼ˆWIPï¼‰
   knowledge.batå¯ä»¥å°†/data/raw_infoä¸‹çš„æ–‡æœ¬æ–‡æ¡£è½½å…¥åˆ°æ•°æ®åº“ï¼ˆæœªå¯åŠ¨ï¼‰

## ğŸ¯ åŠŸèƒ½ä»‹ç»

### ğŸ’¬ èŠå¤©åŠŸèƒ½
- æ”¯æŒå…³é”®è¯æ£€ç´¢ä¸»åŠ¨å‘è¨€ï¼šå¯¹æ¶ˆæ¯çš„è¯é¢˜topicè¿›è¡Œè¯†åˆ«ï¼Œå¦‚æœæ£€æµ‹åˆ°éº¦éº¦å­˜å‚¨è¿‡çš„è¯é¢˜å°±ä¼šä¸»åŠ¨è¿›è¡Œå‘è¨€ï¼Œç›®å‰æœ‰bug,æ‰€ä»¥ç°åœ¨åªä¼šæ£€æµ‹ä¸»é¢˜ï¼Œä¸ä¼šè¿›è¡Œå­˜å‚¨
- æ”¯æŒbotåå­—å‘¼å”¤å‘è¨€ï¼šæ£€æµ‹åˆ°"éº¦éº¦"ä¼šä¸»åŠ¨å‘è¨€ï¼Œå¯é…ç½®
- ä½¿ç”¨ç¡…åŸºæµåŠ¨çš„apiè¿›è¡Œå›å¤ç”Ÿæˆï¼Œå¯éšæœºä½¿ç”¨R1ï¼ŒV3ï¼ŒR1-distillç­‰æ¨¡å‹ï¼Œæœªæ¥å°†åŠ å…¥å®˜ç½‘apiæ”¯æŒ
- åŠ¨æ€çš„promptæ„å»ºå™¨ï¼Œæ›´æ‹Ÿäºº
- æ”¯æŒå›¾ç‰‡ï¼Œè½¬å‘æ¶ˆæ¯ï¼Œå›å¤æ¶ˆæ¯çš„è¯†åˆ«
- é”™åˆ«å­—å’Œå¤šæ¡å›å¤åŠŸèƒ½ï¼šéº¦éº¦å¯ä»¥éšæœºç”Ÿæˆé”™åˆ«å­—ï¼Œä¼šå¤šæ¡å‘é€å›å¤ä»¥åŠå¯¹æ¶ˆæ¯è¿›è¡Œreply

### ğŸ˜Š è¡¨æƒ…åŒ…åŠŸèƒ½
- æ”¯æŒæ ¹æ®å‘è¨€å†…å®¹å‘é€å¯¹åº”æƒ…ç»ªçš„è¡¨æƒ…åŒ…ï¼šæœªå®Œå–„ï¼Œå¯ä»¥ç”¨
- ä¼šè‡ªåŠ¨å·ç¾¤å‹çš„è¡¨æƒ…åŒ…ï¼ˆæœªå®Œå–„ï¼Œæš‚æ—¶ç¦ç”¨ï¼‰ç›®å‰æœ‰bug

### ğŸ“… æ—¥ç¨‹åŠŸèƒ½
- éº¦éº¦ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€å¤©çš„æ—¥ç¨‹ï¼Œå®ç°æ›´æ‹Ÿäººçš„å›å¤

### ğŸ§  è®°å¿†åŠŸèƒ½
- å¯¹èŠå¤©è®°å½•è¿›è¡Œæ¦‚æ‹¬å­˜å‚¨ï¼Œåœ¨éœ€è¦æ—¶è°ƒç”¨ï¼Œæ²¡å†™å®Œ

### ğŸ“š çŸ¥è¯†åº“åŠŸèƒ½
- åŸºäºembeddingæ¨¡å‹çš„çŸ¥è¯†åº“ï¼Œæ‰‹åŠ¨æ”¾å…¥txtä¼šè‡ªåŠ¨è¯†åˆ«ï¼Œå†™å®Œäº†ï¼Œæš‚æ—¶ç¦ç”¨

### ğŸ‘¥ å…³ç³»åŠŸèƒ½
- é’ˆå¯¹æ¯ä¸ªç”¨æˆ·åˆ›å»º"å…³ç³»"ï¼Œå¯ä»¥å¯¹ä¸åŒç”¨æˆ·è¿›è¡Œä¸ªæ€§åŒ–å›å¤ï¼Œç›®å‰åªæœ‰æå…¶ç®€å•çš„å¥½æ„Ÿåº¦ï¼ˆWIPï¼‰
- é’ˆå¯¹æ¯ä¸ªç¾¤åˆ›å»º"ç¾¤å°è±¡"ï¼Œå¯ä»¥å¯¹ä¸åŒç¾¤è¿›è¡Œä¸ªæ€§åŒ–å›å¤ï¼ˆWIPï¼‰

## ğŸš§ å¼€å‘ä¸­åŠŸèƒ½
- äººæ ¼åŠŸèƒ½ï¼šWIP
- ç¾¤æ°›å›´åŠŸèƒ½ï¼šWIP
- å›¾ç‰‡å‘é€ï¼Œè½¬å‘åŠŸèƒ½ï¼šWIP
- å¹½é»˜å’ŒmemeåŠŸèƒ½ï¼šWIPçš„WIP
- è®©éº¦éº¦ç©mcï¼šWIPçš„WIPçš„WIP

## ğŸ“Œ æ³¨æ„äº‹é¡¹
çº¯ç¼–ç¨‹å¤–è¡Œï¼Œé¢å‘cursorç¼–ç¨‹ï¼Œå¾ˆå¤šä»£ç å²ä¸€æ ·å¤šå¤šåŒ…æ¶µ

> âš ï¸ **è­¦å‘Š**ï¼šæœ¬åº”ç”¨ç”Ÿæˆå†…å®¹æ¥è‡ªäººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œç”± AI ç”Ÿæˆï¼Œè¯·ä»”ç»†ç”„åˆ«ï¼Œè¯·å‹¿ç”¨äºè¿åæ³•å¾‹çš„ç”¨é€”ï¼ŒAIç”Ÿæˆå†…å®¹ä¸ä»£è¡¨æœ¬äººè§‚ç‚¹å’Œç«‹åœºã€‚

## è‡´è°¢
[nonebot2](https://github.com/nonebot/nonebot2): è·¨å¹³å° Python å¼‚æ­¥èŠå¤©æœºå™¨äººæ¡†æ¶  
[NapCat](https://github.com/NapNeko/NapCatQQ): ç°ä»£åŒ–çš„åŸºäº NTQQ çš„ Bot åè®®ç«¯å®ç°  

### è´¡çŒ®è€…

æ„Ÿè°¢å„ä½å¤§ä½¬ï¼

[![Contributors](https://contributors-img.web.app/image?repo=SengokuCola/MaiMBot)](https://github.com/SengokuCola/MaiMBot/graphs/contributors)
